# EPUB Documentation Search

A web application for searching and browsing any EPUB ebook with AI-powered semantic search capabilities.

## Features

- üìö Full EPUB content parsing and extraction (supports any EPUB file)
- üîç AI-powered semantic search using sentence transformers
- üîé Keyword-based search fallback
- üìë Table of contents browsing
- üé® Modern, responsive UI
- ‚ö° Fast API backend with FastAPI
- üê≥ Docker support with easy EPUB mounting

## Quick Start

### Using the startup script

```bash
# Specify the EPUB file directly
./start.sh /path/to/your/book.epub

# Or use environment variable
EPUB_PATH=/path/to/your/book.epub ./start.sh

# Auto-detect: if there's an .epub file in the current directory
./start.sh
```

### Using Docker

```bash
# Build the image
docker build -t epub-search .

# Run with your EPUB file mounted
docker run -p 8000:8000 -v /path/to/your/book.epub:/data/book.epub epub-search

# Or specify a custom path
docker run -p 8000:8000 \
  -v /path/to/your/book.epub:/books/mybook.epub \
  -e EPUB_PATH=/books/mybook.epub \
  epub-search
```

### Manual Setup

1. **Install dependencies (using uv):**
   ```bash
   uv sync
   ```

2. **Parse the EPUB:**
   ```bash
   uv run python epub_parser.py /path/to/your/book.epub
   # Or using environment variable
   EPUB_PATH=/path/to/your/book.epub uv run python epub_parser.py
   ```
   This will create `content.json` with all extracted content.

3. **Start the server:**
   ```bash
   uv run python app.py
   ```

4. **Open in browser:**
   Navigate to `http://localhost:8000`

## Configuration

The EPUB file path can be specified in multiple ways (in order of priority):

1. **Command line argument:** `python epub_parser.py /path/to/book.epub`
2. **Environment variable:** `EPUB_PATH=/path/to/book.epub`
3. **Auto-detection:** Any `.epub` file in the current directory

## Usage

### Search
- Enter your query in the search box
- Toggle "Use AI Semantic Search" for semantic search (recommended) or keyword search
- Click results to view full content

### Browse
- Click "Browse Table of Contents" to see all chapters
- Click any chapter to view its content

## Architecture

- `epub_parser.py` - Parses EPUB files (both `.epub` archives and extracted directories)
- `app.py` - FastAPI backend with search endpoints
- `static/index.html` - Frontend UI
- `content.json` - Parsed content (generated by parser)

## Search Modes

1. **Semantic Search (AI)**: Uses sentence transformers to find semantically similar content. Better for conceptual queries.
2. **Keyword Search**: Simple keyword matching. Faster but less intelligent.

## Notes

- Supports both `.epub` files and extracted EPUB directories
- The first run will download the sentence transformer model (~80MB)
- Vector embeddings are generated on startup (may take a minute)
- Images from the EPUB are served from `/graphics/`

## Requirements

- Python 3.10+
- See `pyproject.toml` for package dependencies
